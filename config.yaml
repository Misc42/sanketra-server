# NOTE: This file is NOT loaded by the server. It serves as documentation for configuration options.
#
# mic_on_term Configuration
# Speech-to-Text with Hindi/Hinglish support

# ============================================================================
#                          AUDIO PREPROCESSING
# ============================================================================
# Background noise filtering using pre-emphasis + high-pass filter
# Improves transcription quality in noisy environments without affecting accuracy

audio_preprocessing:
  # Master toggle - set to false to disable all preprocessing
  enabled: true

  # Pre-emphasis coefficient (0.90-0.99)
  # Higher = more high-frequency boost (better for noisy environments)
  # Lower = less processing (better for clean recordings)
  # Default 0.97 is standard for speech processing
  preemphasis_coef: 0.97

  # High-pass filter cutoff frequency (50-150 Hz)
  # Removes low-frequency rumble (fan noise, AC hum, traffic)
  # Default 80Hz preserves voice fundamentals (85-255Hz)
  # Higher = more aggressive filtering
  highpass_cutoff: 80

  # High-pass filter order (1-4)
  # Higher = sharper cutoff, more processing
  # Default 2 is good balance
  highpass_order: 2

  # Preserve original energy for VAD accuracy
  # Keep enabled unless you experience VAD detection issues
  preserve_vad_energy: true


# ============================================================================
#                          MOBILE SETTINGS
# ============================================================================
# Mobile-specific features for iOS and Android

mobile:
  # WebSocket auto-reconnection on network dropout
  # Exponential backoff: 1s, 2s, 5s, 10s (max 5 attempts)
  websocket_reconnect: true

  # Automatic gain control (normalizes volume)
  # Helps with quiet or loud speakers
  auto_gain_control: true

  # Adaptive sample rate handling
  # iOS often uses 48kHz despite 16kHz request
  # Our AudioWorklet handles resampling automatically
  adaptive_sample_rate: true


# ============================================================================
#                          PRESET CONFIGURATIONS
# ============================================================================
# Quick presets for different use cases
# To use: Modify audio_preprocessing values based on preset below

presets:
  # Clean environment (quiet room, headset mic)
  clean:
    enabled: false  # No preprocessing needed

  # Light noise (home/office with some background)
  light:
    enabled: true
    preemphasis_coef: 0.90
    highpass_cutoff: 60

  # Medium noise (cafe, street with moderate traffic)
  medium:
    enabled: true
    preemphasis_coef: 0.95
    highpass_cutoff: 80

  # Heavy noise (busy street, construction, AC/fan)
  heavy:
    enabled: true
    preemphasis_coef: 0.97
    highpass_cutoff: 100
    highpass_order: 3

  # Maximum filtering (very noisy environments)
  maximum:
    enabled: true
    preemphasis_coef: 0.99
    highpass_cutoff: 120
    highpass_order: 4


# ============================================================================
#                      PHYSICAL INPUT DETECTION
# ============================================================================
# Auto-pause app input when laptop keyboard/mouse is used.
# Resumes when phone sends any WebSocket activity (trackpad/mic).
# Linux only. Requires read access to /dev/input/event* (add user to 'input' group).
# Disable with --no-input-guard flag on server startup.

physical_input_detection:
  enabled: true


# ============================================================================
#                          ADVANCED SETTINGS
# ============================================================================

advanced:
  # Transcription model selection
  # Options: "fast", "balanced", "accurate", "custom"
  # Set via command-line: --fast, --balanced, --accurate, --custom
  model_preference: balanced

  # Enable debug logging
  # Creates detailed logs in mic_on_term_YYYY-MM-DD.log
  debug_logging: false

  # GPU acceleration
  # Automatically detected, but can be forced off
  force_cpu: false


# ============================================================================
#                          NOTES
# ============================================================================
# 1. Changes to this file require server restart to take effect
# 2. Command-line flags override config file settings
# 3. To disable preprocessing: set enabled: false or use --no-preprocessing flag
# 4. For accuracy testing: Compare with/without preprocessing in same environment
# 5. iOS sample rate: System may use 48kHz - this is handled automatically
# 6. Battery impact: Preprocessing adds ~0.25ms per frame (negligible)
# 7. Accuracy guarantee: 89% baseline maintained with default settings
